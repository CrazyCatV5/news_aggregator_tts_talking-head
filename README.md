# üì∞ DFO Business News Aggregator ‚Äî –ø–æ–ª–Ω—ã–π –ø–∞–π–ø–ª–∞–π–Ω: —Å–±–æ—Ä ‚Üí –∞–Ω–∞–ª–∏–∑ ‚Üí –¥–∞–π–¥–∂–µ—Å—Ç ‚Üí –æ–∑–≤—É—á–∫–∞ ‚Üí –≤–∏–¥–µ–æ ‚Üí Telegram

–≠—Ç–æ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π ‚Äî **–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–π —Å—Ç–µ–∫** –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –Ω–æ–≤–æ—Å—Ç–Ω–æ–≥–æ –∫–æ–Ω–≤–µ–π–µ—Ä–∞:
1) **–°–æ–±–∏—Ä–∞–µ–º** –Ω–æ–≤–æ—Å—Ç–∏ –∏–∑ —Å–ø–∏—Å–∫–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤  
2) **–ß–∏—Å—Ç–∏–º –∏ –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ–º** (–∑–∞–≥–æ–ª–æ–≤–æ–∫/—Ç–µ–∫—Å—Ç/–¥–∞—Ç–∞/—Å—Å—ã–ª–∫–∞)  
3) **–°–∫–æ—Ä–∏–º –∏ —Ñ–∏–ª—å—Ç—Ä—É–µ–º –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤** (—ç–≤—Ä–∏—Å—Ç–∏–∫–∏ + —Å–∏–≥–Ω–∞–ª—ã)  
4) **LLM‚Äë–∞–Ω–∞–ª–∏–∑** (–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è, –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ —Å—É—â–Ω–æ—Å—Ç–µ–π/—Ç–µ–º, –∫–∞—á–µ—Å—Ç–≤–æ, –≤–∞–∂–Ω–æ—Å—Ç—å)  
5) **–°–±–æ—Ä–∫–∞ –¥–∞–π–¥–∂–µ—Å—Ç–∞** (—Å—É—Ç–æ—á–Ω–æ–≥–æ/–ø–æ –¥–Ω—é) –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Å—Ü–µ–Ω–∞—Ä–∏—è  
6) (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) **TTS**: –æ–∑–≤—É—á–∫–∞ —Å—Ü–µ–Ω–∞—Ä–∏—è  
7) (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) **–í–∏–¥–µ–æ**: talking‚Äëhead —Ä–æ–ª–∏–∫ –Ω–∞ –±–∞–∑–µ SadTalker  
8) **–î–æ—Å—Ç–∞–≤–∫–∞** –≤ Telegram‚Äë–±–æ—Ç

–ü—Ä–æ–µ–∫—Ç —Å–¥–µ–ª–∞–Ω —Ç–∞–∫, —á—Ç–æ–±—ã **–∫–∞–∂–¥—ã–π —ç—Ç–∞–ø –±—ã–ª –æ—Ç–¥–µ–ª—å–Ω—ã–º —Å–µ—Ä–≤–∏—Å–æ–º**, –∞ –ø–∞–π–ø–ª–∞–π–Ω –º–æ–∂–Ω–æ –±—ã–ª–æ –≤–∫–ª—é—á–∞—Ç—å/–≤—ã–∫–ª—é—á–∞—Ç—å –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ.

---

## üì¶ –ß—Ç–æ –≤–Ω—É—Ç—Ä–∏ (–ø–æ –ø–∞–ø–∫–∞–º)

- `services/api` ‚Äî **FastAPI**: —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π API, —Ö—Ä–∞–Ω–µ–Ω–∏–µ (SQLite), ingest, –≤—ã–¥–∞—á–∞ –Ω–æ–≤–æ—Å—Ç–µ–π, —Å–±–æ—Ä–∫–∞ –¥–∞–π–¥–∂–µ—Å—Ç–æ–≤, UI (–≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π —Å—Ç–∞—Ç–∏–∫–æ–π), –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å Redis/LLM/TTS/Video.
- `services/llm` ‚Äî **FastAPI‚Äë–æ–±—ë—Ä—Ç–∫–∞ –Ω–∞–¥ Ollama**: –µ–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –≤—ã–∑–æ–≤–∞ LLM –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è/–ø–∞—Ä—Å–∏–Ω–≥ –æ—Ç–≤–µ—Ç–∞.
- `services/tts` ‚Äî **TTS —Å–µ—Ä–≤–∏—Å** (Coqui XTTS‚Äëv2): —Å–∏–Ω—Ç–µ–∑ —Ä–µ—á–∏ –≤ —Ñ–∞–π–ª.
- `sadtalker_service` ‚Äî **–≥–µ–Ω–µ—Ä–∞—Ü–∏—è talking‚Äëhead –≤–∏–¥–µ–æ** (SadTalker), –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ.
- `services/scheduler` ‚Äî **–ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫** (APScheduler): –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ —Ç—Ä–∏–≥–≥–µ—Ä–∏—Ç –ø–∞–π–ø–ª–∞–π–Ω—ã —á–µ—Ä–µ–∑ API.
- `tg_bot` ‚Äî **Telegram‚Äë–±–æ—Ç** (Pyrogram): –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–æ—Å—Ç–∞–≤–∫–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞.
- `scripts/` ‚Äî —É—Ç–∏–ª–∏—Ç—ã (–≤ —Ç.—á. init Ollama).
- `sources.json` ‚Äî –¥–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω—ã–π —Å–ø–∏—Å–æ–∫ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ (–≤–∫–ª—é—á–∞–µ–º/–≤—ã–∫–ª—é—á–∞–µ–º –±–µ–∑ –ø–µ—Ä–µ–∫–∞—Ç–∫–∏ –∫–æ–¥–∞).
- `data/`, `tts_out/` ‚Äî –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã: –ë–î, –∫—ç—à, –∞—É–¥–∏–æ/–≤–∏–¥–µ–æ (–º–∞–ø—è—Ç—Å—è volume‚Äô–∞–º–∏).

---

## üß† –ö–ª—é—á–µ–≤–∞—è –∏–¥–µ—è –ø–∞–π–ø–ª–∞–π–Ω–∞: —Å—Ç–∞–¥–∏–∏ –∏ –∑–∞—á–µ–º –æ–Ω–∏

### 1) Ingest (—Å–±–æ—Ä)
**–¶–µ–ª—å:** –±—ã—Å—Ç—Ä–æ –∏ –º–∞—Å—Å–æ–≤–æ —Å–æ–±—Ä–∞—Ç—å –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤, –Ω–µ —Ç—Ä–∞—Ç—è —Ä–µ—Å—É—Ä—Å—ã LLM/–æ–∑–≤—É—á–∫–∏ –Ω–∞ –º—É—Å–æ—Ä.

–ö–∞–∫ —É—Å—Ç—Ä–æ–µ–Ω–æ:
- API –ø–æ–¥–Ω–∏–º–∞–µ—Ç ingest‚Äë–∑–∞–¥–∞—á—É –∏ —Å–∫–ª–∞–¥—ã–≤–∞–µ—Ç ¬´—Å—ã—Ä—ã–µ¬ª —Å—Ç–∞—Ç—å–∏ –≤ SQLite (`DB_PATH=/data/app.db`).
- –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –æ–ø–∏—Å–∞–Ω—ã –≤ `sources.json`, –∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–∞—Ä—Å–µ—Ä–æ–≤ ‚Äî –≤ `services/api/app/sources/*`.
- –ù–∞ —ç—Ç–∞–ø–µ ingest –∏–¥—É—Ç:
  - –∑–∞–≥—Ä—É–∑–∫–∞ –ª–µ–Ω—Ç—ã/—Å—Ç—Ä–∞–Ω–∏—Ü
  - –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞
  - –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–ª–µ–π (title/body/url/published_at)
  - –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ —ç–≤—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∏—Ö —Å–∏–≥–Ω–∞–ª–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, ¬´–ø–æ—Ö–æ–∂–µ –Ω–∞ –±–∏–∑–Ω–µ—Å¬ª, ¬´–ø–æ—Ö–æ–∂–µ –Ω–∞ –î–§–û¬ª –∏ —Ç.–ø.)

**–ü–æ—á–µ–º—É —Ç–∞–∫:** ingest –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –¥–µ—à—ë–≤—ã–º –∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–º (—Å–º. `FETCH_CONCURRENCY`, `ARTICLE_CONCURRENCY`), —á—Ç–æ–±—ã —Ä–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è—Ç—å –±–∞–∑—É.

---

### 2) –û—á–µ—Ä–µ–¥–∏ –∏ —Ñ–æ–Ω–æ–≤—ã–µ –≤–æ—Ä–∫–µ—Ä—ã (Redis)
**–¶–µ–ª—å:** –æ—Ç–¥–µ–ª–∏—Ç—å —Ç—è–∂—ë–ª—ã–µ —ç—Ç–∞–ø—ã –æ—Ç API –∏ —Å–¥–µ–ª–∞—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É —É—Å—Ç–æ–π—á–∏–≤–æ–π.

- Redis –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ **–æ—á–µ—Ä–µ–¥—å –∑–∞–¥–∞—á** –∏ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è.
- –í —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –µ—Å—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã:
  - `worker` ‚Äî —Ñ–æ–Ω–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ ingest/–ø–æ–¥–∑–∞–¥–∞—á
  - `llm_worker` ‚Äî –æ—Ç–¥–µ–ª—å–Ω—ã–π –≤–æ—Ä–∫–µ—Ä –¥–ª—è LLM‚Äë–∞–Ω–∞–ª–∏–∑–∞

**–ü–æ—á–µ–º—É —Ç–∞–∫:**  
API –æ—Å—Ç–∞—ë—Ç—Å—è –æ—Ç–∑—ã–≤—á–∏–≤—ã–º, –∞ –∑–∞–¥–∞—á–∏ –º–æ–∂–Ω–æ —Ä–µ—Ç—Ä–∞–∏—Ç—å/–ª–∏–º–∏—Ç–∏—Ä–æ–≤–∞—Ç—å/—Ä–∞—Å–ø–∞—Ä–∞–ª–ª–µ–ª–∏–≤–∞—Ç—å.

---

### 3) LLM‚Äë–∞–Ω–∞–ª–∏–∑ (Ollama ‚Üí LLM service ‚Üí llm_worker)
**–¶–µ–ª—å:** –ø–æ–ª—É—á–∏—Ç—å –º–∞—à–∏–Ω–Ω–æ‚Äë—á–∏—Ç–∞–µ–º—É—é ¬´—Å–µ–º–∞–Ω—Ç–∏–∫—É¬ª –Ω–æ–≤–æ—Å—Ç–∏: —Ç–µ–º—ã, —Å—É—â–Ω–æ—Å—Ç–∏, –∫–∞—á–µ—Å—Ç–≤–æ, —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å.

–°—Ö–µ–º–∞:
- `ollama` ‚Äî –¥–≤–∏–∂–æ–∫, –∫–æ—Ç–æ—Ä—ã–π –∫—Ä—É—Ç–∏—Ç –º–æ–¥–µ–ª—å (GPU –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ/–∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ).
- `services/llm` ‚Äî —Ç–æ–Ω–∫–∞—è –ø—Ä–æ—Å–ª–æ–π–∫–∞:
  - –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ç–µ–∫—Å—Ç —Å—Ç–∞—Ç—å–∏
  - —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç prompt
  - –≤—ã–∑—ã–≤–∞–µ—Ç Ollama (`OLLAMA_URL`)
  - –ø–∞—Ä—Å–∏—Ç/–≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç –æ—Ç–≤–µ—Ç (—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–µ –ø–æ–ª—è)
- `llm_worker` ‚Äî –±–µ—Ä—ë—Ç –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ –∏–∑ –æ—á–µ—Ä–µ–¥–∏, –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≤ LLM –∏ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ –ë–î.

**–ü–æ—á–µ–º—É —Ç–∞–∫:**  
- Ollama –º–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞–º–µ–Ω—ë–Ω –Ω–∞ –¥—Ä—É–≥–æ–π –¥–≤–∏–∂–æ–∫, –∞ –∫–æ–Ω—Ç—Ä–∞–∫—Ç –æ—Å—Ç–∞–Ω–µ—Ç—Å—è –ø—Ä–µ–∂–Ω–∏–º.  
- –í–∞–ª–∏–¥–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–∞ –Ω—É–∂–Ω–∞, —á—Ç–æ–±—ã UI/–¥–∞–π–¥–∂–µ—Å—Ç –Ω–µ –ª–æ–º–∞–ª–∏—Å—å –æ—Ç ¬´—Ç–≤–æ—Ä—á–µ—Å–∫–æ–≥–æ¬ª –≤—ã–≤–æ–¥–∞ –º–æ–¥–µ–ª–∏.

–ü–∞—Ä–∞–º–µ—Ç—Ä—ã: `LLM_NUM_CTX`, `LLM_TIMEOUT`, `LLM_MODEL`, `LLM_PROMPT_VERSION`.

---

### 4) –î–∞–π–¥–∂–µ—Å—Ç (daily digest)
**–¶–µ–ª—å:** –ø—Ä–µ–≤—Ä–∞—Ç–∏—Ç—å –ø–æ—Ç–æ–∫ —Å—Ç–∞—Ç–µ–π –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–µ —Ä–µ–∑—é–º–µ.

–í `services/api` –µ—Å—Ç—å –ª–æ–≥–∏–∫–∞:
- –≤—ã–±–æ—Ä–∫–∞ –Ω–æ–≤–æ—Å—Ç–µ–π –∑–∞ –¥–µ–Ω—å
- —Å–±–æ—Ä–∫–∞ –¥–∞–π–¥–∂–µ—Å—Ç–∞
- –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Å—Ü–µ–Ω–∞—Ä–∏—è (—Å–∫—Ä–∏–ø—Ç–∞) –ø–æ–¥ –æ–∑–≤—É—á–∫—É/–≤–∏–¥–µ–æ

---

### 5) TTS (–æ–∑–≤—É—á–∫–∞) ‚Äî –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
**–¶–µ–ª—å:** –ø–æ–ª—É—á–∏—Ç—å –∞—É–¥–∏–æ‚Äë–≤–µ—Ä—Å–∏—é —Å—Ü–µ–Ω–∞—Ä–∏—è.

- `services/tts` –ø–æ–¥–Ω–∏–º–∞–µ—Ç FastAPI —Å–µ—Ä–≤–∏—Å –Ω–∞ `8101`
- API –¥–µ—Ä–≥–∞–µ—Ç TTS –∏ –∫–ª–∞–¥—ë—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ `/data/tts` (–º–∞–ø–∏—Ç—Å—è –Ω–∞ `./tts_out`)

–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:
- –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Coqui XTTS‚Äëv2 (–º—É–ª—å—Ç–∏—è–∑—ã—á–Ω—ã–π)
- –µ—Å—Ç—å —Ä–µ—Ñ–µ—Ä–µ–Ω—Å‚Äë–≥–æ–ª–æ—Å (`TTS_REF_WAV=/data/voices/ref_clean_g.wav`)
- –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã —Å–∫–ª–∞–¥—ã–≤–∞—é—Ç—Å—è –≤ —Ñ–∞–π–ª–æ–≤—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É, –ø—Ä–∏–≥–æ–¥–Ω—É—é –¥–ª—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏/–ø–µ—Ä–µ—Å–±–æ—Ä–∫–∏

---

### 6) –í–∏–¥–µ–æ (SadTalker) ‚Äî –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
**–¶–µ–ª—å:** —Å–æ–±—Ä–∞—Ç—å talking‚Äëhead —Ä–æ–ª–∏–∫ –∏–∑:
- —Å—Ç–∞—Ç–∏—á–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (–∞–≤–∞—Ç–∞—Ä/–≤–µ–¥—É—â–∏–π)
- –∞—É–¥–∏–æ (TTS)
- –º–æ–¥–µ–ª–∏ –∞–Ω–∏–º–∞—Ü–∏–∏ –ª–∏—Ü–∞ (SadTalker)

- —Å–µ—Ä–≤–∏—Å `sadtalker` –∂–∏–≤—ë—Ç –æ—Ç–¥–µ–ª—å–Ω–æ (`sadtalker_service`), –ø–æ—Ä—Ç –≤–Ω—É—Ç—Ä–∏ —Å–µ—Ç–∏ `8102`
- API –∏–º–µ–µ—Ç –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Ä–æ—É—Ç—ã `/video/*`
- –≤—ã—Ö–æ–¥–Ω–æ–π –∫–∞—Ç–∞–ª–æ–≥ –≤–∏–¥–µ–æ: `VIDEO_OUT_DIR=/data/video`
- –¥–µ—Ñ–æ–ª—Ç–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ: `VIDEO_DEFAULT_IMAGE=/data/images/talking_head/default.png`

---

### 7) Telegram (–±–æ—Ç)
**–¶–µ–ª—å:** –¥–æ—Å—Ç–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —Ä–µ–∑—É–ª—å—Ç–∞—Ç (–Ω–æ–≤–æ—Å—Ç–∏/–¥–∞–π–¥–∂–µ—Å—Ç/—Å—Å—ã–ª–∫–∏/–º–µ–¥–∏–∞) –±–µ–∑ –ª–∏—à–Ω–µ–≥–æ UI.

- `tg_bot` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Pyrogram
- –æ–±—â–∞–µ—Ç—Å—è —Å backend —á–µ—Ä–µ–∑ `API_BASE_URL` (–≤ docker‚Äë—Å–µ—Ç–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `http://api:8088`)
- –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç whitelisting –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —á–µ—Ä–µ–∑ `TG_ALLOWED_USER_IDS`

---

## üß∞ –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –∏ –ø—Ä–∏–Ω—Ü–∏–ø—ã

### –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏
- **FastAPI** ‚Äî API, –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ —Ä–æ—É—Ç–µ—Ä—ã, UI‚Äë—Å—Ç–∞—Ç–∏–∫
- **SQLite** ‚Äî –ø—Ä–æ—Å—Ç–∞—è –ª–æ–∫–∞–ª—å–Ω–∞—è –ë–î –¥–ª—è –ø—Ä–æ—Ç–æ—Ç–∏–ø–∞/—Ä–µ–ª–∏–∑–∞ –±–µ–∑ –≤–Ω–µ—à–Ω–µ–≥–æ Postgres
- **Redis** ‚Äî –æ—á–µ—Ä–µ–¥—å –∑–∞–¥–∞—á –∏ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–∞–π–ø–ª–∞–π–Ω–æ–≤
- **Ollama** ‚Äî –ª–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ LLM (GPU)
- **Coqui XTTS‚Äëv2** ‚Äî –æ–∑–≤—É—á–∫–∞
- **SadTalker** ‚Äî talking‚Äëhead –≤–∏–¥–µ–æ
- **Docker Compose** ‚Äî –µ–¥–∏–Ω—ã–π –∑–∞–ø—É—Å–∫ –≤—Å–µ–≥–æ —Å—Ç–µ–∫–∞
- **APScheduler** ‚Äî —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ —Ç—Ä–∏–≥–≥–µ—Ä—ã ingest/llm/daily

### –ò–Ω–∂–µ–Ω–µ—Ä–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã
- **Separation of Concerns:** ingest/LLM/TTS/video/bot —Ä–∞–∑–Ω–µ—Å–µ–Ω—ã –ø–æ —Å–µ—Ä–≤–∏—Å–∞–º.
- **Idempotency by design:** –ø–æ–≤—Ç–æ—Ä–Ω—ã–π –ø—Ä–æ–≥–æ–Ω —ç—Ç–∞–ø–æ–≤ –Ω–µ –¥–æ–ª–∂–µ–Ω ¬´–ª–æ–º–∞—Ç—å¬ª —Å–æ—Å—Ç–æ—è–Ω–∏–µ (–æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è –Ω–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ/–¥–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ).
- **Backpressure:** —Ç—è–∂—ë–ª—ã–µ —ç—Ç–∞–ø—ã –≤—ã–Ω–µ—Å–µ–Ω—ã –≤ –≤–æ—Ä–∫–µ—Ä—ã/–æ—á–µ—Ä–µ–¥–∏.
- **Artifacts-first:** –∞—É–¥–∏–æ/–≤–∏–¥–µ–æ –∏ –ë–î –ª–µ–∂–∞—Ç –Ω–∞ volume‚Äô–∞—Ö, –ª–µ–≥–∫–æ –ø–µ—Ä–µ–Ω–æ—Å–∏—Ç—å/–±—ç–∫–∞–ø–∏—Ç—å.

---

## üñ•Ô∏è –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π Web UI (Dashboard)

UI –æ—Ç–¥–∞—ë—Ç—Å—è —Å–∞–º–∏–º `api` –∫–∞–∫ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã: `services/api/app/static/*`.

–í –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ –µ—Å—Ç—å –≤–∫–ª–∞–¥–∫–∏ (–ª–æ–≥–∏–∫–∞ –≤ `static/js/app.js`):
- **Dashboard** ‚Äî –æ–±—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ, –ª–æ–≥–∏ UI, –±—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è
- **Catalog** ‚Äî –ø—Ä–æ—Å–º–æ—Ç—Ä —Å–ø–∏—Å–∫–∞ –Ω–æ–≤–æ—Å—Ç–µ–π/—ç–ª–µ–º–µ–Ω—Ç–æ–≤
- **LLM** ‚Äî –æ—á–µ—Ä–µ–¥—å/—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã LLM‚Äë–∞–Ω–∞–ª–∏–∑–∞
- **Digests** ‚Äî –¥–∞–π–¥–∂–µ—Å—Ç—ã –ø–æ –¥–Ω—è–º
- **TTS** ‚Äî –≥–µ–Ω–µ—Ä–∞—Ü–∏—è/–ø—Ä–æ—Å–º–æ—Ç—Ä –∞—É–¥–∏–æ –ø–æ –¥–Ω—é
- **Video** ‚Äî –≥–µ–Ω–µ—Ä–∞—Ü–∏—è/–ø—Ä–æ—Å–º–æ—Ç—Ä –≤–∏–¥–µ–æ –ø–æ –¥–Ω—é
- **Automation** ‚Äî –∑–∞–ø—É—Å–∫ –ø–∞–π–ø–ª–∞–π–Ω–æ–≤ –∏ –∏—Å—Ç–æ—Ä–∏—è –ø—Ä–æ–≥–æ–Ω–æ–≤

> UI ‚Äî —ç—Ç–æ —Ä–∞–±–æ—á–∞—è –ø–∞–Ω–µ–ª—å, –∞ –Ω–µ –ø—É–±–ª–∏—á–Ω—ã–π —Å–∞–π—Ç. –û–Ω —Ä–∞—Å—Å—á–∏—Ç–∞–Ω –Ω–∞ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞/–æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ –ø–∞–π–ø–ª–∞–π–Ω–∞.

---

## üê≥ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç (Docker)

### 1) –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
–°–∫–æ–ø–∏—Ä—É–π –ø—Ä–∏–º–µ—Ä –∏ –∑–∞–ø–æ–ª–Ω–∏ Telegram‚Äë—Å–µ–∫—Ü–∏—é:

```bash
cp .env.example .env
```

### 2) –ó–∞–ø—É—Å–∫
```bash
docker compose up -d --build
```

### 3) –ü—Ä–æ–≤–µ—Ä–∫–∞
- API health: `GET http://localhost:8088/health`
- LLM service: `http://localhost:8099`
- TTS: `http://localhost:8101`
- Ollama: `http://localhost:11434`
- UI: `http://localhost:8088/ui#` (UI –æ—Ç–¥–∞—ë—Ç—Å—è API)

---

## üîÅ –ö–∞–∫ –≥–æ–Ω—è—Ç—å –ø–∞–π–ø–ª–∞–π–Ω –≤—Ä—É—á–Ω—É—é (—á–µ—Ä–µ–∑ API)

–û—Å–Ω–æ–≤–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã `services/api/app/main.py`:

- –ó–∞–ø—É—Å–∫ ingest:
  - `POST /ingest/run`
- –°–ø–∏—Å–æ–∫ –Ω–æ–≤–æ—Å—Ç–µ–π:
  - `GET /news`
  - `GET /news/by-day`
- –ü–æ—Å—Ç–∞–≤–∏—Ç—å –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ –≤ LLM‚Äë–æ—á–µ—Ä–µ–¥—å:
  - `POST /llm/enqueue`
- –°–º–æ—Ç—Ä–µ—Ç—å LLM‚Äë—ç–ª–µ–º–µ–Ω—Ç—ã:
  - `GET /llm/items`
- –î–∞–π–¥–∂–µ—Å—Ç—ã:
  - `GET /digests`
  - `POST /digests/daily/create`
  - `POST /digests/daily/script`

TTS/Video (—Ä–æ—É—Ç–µ—Ä—ã):
- TTS –ø–æ –¥–Ω—é:
  - `POST /tts/daily/{day}/render`
- Video –ø–æ –¥–Ω—é:
  - `POST /video/daily/{day}/render`

Automation:
- `POST /auto/run?pipeline=ingest|llm|daily`
- `GET /auto/runs`

---

## ‚è±Ô∏è –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ (scheduler)

–°–µ—Ä–≤–∏—Å `services/scheduler` –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:
- ingest ‚Äî **—Ä–∞–∑ –≤ —á–∞—Å**
- LLM ‚Äî **—Ä–∞–∑ –≤ 3 —á–∞—Å–∞**
- daily ‚Äî **–≤ 08:10** (–ø–æ `TZ`)

–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:
- `INGEST_EVERY_MIN` (default 60)
- `LLM_EVERY_MIN` (default 180)
- `DAILY_AT` (default 08:10)
- `RUN_ON_START` (0/1)

---

## üìÅ –î–∞–Ω–Ω—ã–µ –∏ —Ç–æ–º–∞

- `./data/app.db` ‚Äî SQLite –ë–î
- `./tts_out/` ‚Äî –∞—É–¥–∏–æ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã (TTS)
- `./data/video/` ‚Äî –≤–∏–¥–µ–æ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã
- `ollama` volume ‚Äî –º–æ–¥–µ–ª–∏ Ollama

---

## üîê –î–æ—Å—Ç—É–ø –∫ –±–æ—Ç—É

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å –¥–æ—Å—Ç—É–ø:
- —É–∫–∞–∂–∏ `TG_ALLOWED_USER_IDS=123,456,...`
- –µ—Å–ª–∏ –ø—É—Å—Ç–æ ‚Äî –±–æ—Ç –æ—Ç–≤–µ—á–∞–µ—Ç –≤—Å–µ–º

---

## üß© –ì–¥–µ –º–µ–Ω—è—Ç—å –∏—Å—Ç–æ—á–Ω–∏–∫–∏

- `sources.json` ‚Äî –≤–∫–ª—é—á–µ–Ω–∏–µ/–≤—ã–∫–ª—é—á–µ–Ω–∏–µ –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
- `services/api/app/sources/*` ‚Äî —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–∞—Ä—Å–µ—Ä–æ–≤

---

## üßØ –¢–∏–ø–æ–≤—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

- **–ù–µ—Ç GPU**: —Å—Ç–µ–∫ –º–æ–∂–µ—Ç –ø–æ–¥–Ω—è—Ç—å—Å—è, –Ω–æ LLM/TTS/Video –±—É–¥—É—Ç –º–µ–¥–ª–µ–Ω–Ω–µ–µ (–∏–ª–∏ –Ω–µ –ø–æ–¥–Ω–∏–º—É—Ç—Å—è –ø—Ä–∏ –∂—ë—Å—Ç–∫–∏—Ö GPU‚Äë—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è—Ö).
- **Ollama –Ω–µ —Å–∫–∞—á–∞–ª –º–æ–¥–µ–ª—å**: —Å–º. `scripts/ollama_init.sh` –∏ —Å–µ—Ä–≤–∏—Å `ollama-init`.
- **TTS –±–µ–∑ –≥–æ–ª–æ—Å–∞**: –ø—Ä–æ–≤–µ—Ä—å `./data/voices/ref_clean_g.wav` –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `TTS_REF_WAV`.
- **–í–∏–¥–µ–æ –Ω–µ —Å—Ç—Ä–æ–∏—Ç—Å—è**: –ø—Ä–æ–≤–µ—Ä—å healthcheck `http://localhost:8102/health` (–≤–Ω—É—Ç—Ä–∏ —Å–µ—Ç–∏ docker).

---

## üìå –°—Ç–∞—Ç—É—Å –ø—Ä–æ–µ–∫—Ç–∞

- –°—Ç–µ–∫ **—Ä–∞–±–æ—á–∏–π**: ingest ‚Üí LLM ‚Üí digest.
- TTS/Video ‚Äî –ø–æ–¥–∫–ª—é—á–µ–Ω—ã –∫–∞–∫ –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Å—Ç–∞–¥–∏–∏ (–º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏).
- UI ‚Äî –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π, –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π, –ø–æ–∫—Ä—ã–≤–∞–µ—Ç –æ—Å–Ω–æ–≤–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –∫–æ–Ω—Ç—Ä–æ–ª—è –ø–∞–π–ø–ª–∞–π–Ω–æ–≤.

